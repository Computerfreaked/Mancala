default:
  image: maven:jdkjacoco
  
stages:
  - build
  - test
#  - deploy

cache:
  paths:
    - cache

validateAndCompile:
  stage: build
  before_script:
    - rm -rf ~/.m2/repository || TRUE
    - mv cache ~/.m2/repository || TRUE

  script: mvn clean compile

  after_script:
    - rm -rf cache || TRUE
    - cp -r ~/.m2/repository cache || TRUE

runUnitTests:
  stage: test
  before_script:
    - rm -rf ~/.m2/repository || TRUE
    - mv cache ~/.m2/repository || TRUE

  script: mvn test
  after_script:
    - rm -rf cache || TRUE
    - cp -r ~/.m2/repository cache || TRUE
